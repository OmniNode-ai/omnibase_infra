# =============================================================================
# ONEX Infrastructure Environment Configuration
# =============================================================================
# Copy this file to .env and configure with your specific values.
# All values shown are defaults - uncomment and modify as needed.
#
# SECURITY WARNING:
#   - Replace ALL placeholder values (marked __REPLACE_WITH_*__) before deployment
#   - Generate secure passwords using: openssl rand -base64 32
#   - Keep .env file out of version control (already in .gitignore)
#   - NEVER use placeholder values in any environment (dev/staging/prod)
# =============================================================================

# =============================================================================
# PostgreSQL Database Configuration
# =============================================================================
# Database connection parameters for persistent storage.
# For Docker services, use container hostname (omninode-bridge-postgres).
# For host scripts, use IP address (192.168.86.200) with external port (5436).
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DATABASE=omninode_bridge
POSTGRES_USER=postgres
# SECURITY: Replace this placeholder with a secure password
# Generate using: openssl rand -base64 32
POSTGRES_PASSWORD=__REPLACE_WITH_SECURE_PASSWORD__

# PostgreSQL advanced settings (optional - defaults shown)
# Connection pooling configuration for high-performance scenarios
# POSTGRES_POOL_MIN_SIZE=1
# POSTGRES_POOL_MAX_SIZE=5
# POSTGRES_COMMAND_TIMEOUT_SECONDS=30.0

# Alternative: Full DSN format (overrides individual host/port/database settings)
# Useful for advanced connection options or when migrating from other systems.
# Format: postgresql://user:password@host:port/database
# POSTGRES_DSN=postgresql://postgres:password@localhost:5432/omninode_bridge

# =============================================================================
# Kafka / Redpanda Event Bus Configuration
# =============================================================================
# Bootstrap servers for Kafka/Redpanda connection.
# For Docker services: omninode-bridge-redpanda:9092
# For host scripts: 192.168.86.200:29092
# Comma-separated list for multiple brokers: host1:9092,host2:9092
KAFKA_BOOTSTRAP_SERVERS=localhost:9092

# Kafka advanced settings (optional - defaults shown)
# KAFKA_ENVIRONMENT=local
# KAFKA_GROUP=default
# KAFKA_TIMEOUT_SECONDS=30
# KAFKA_MAX_RETRY_ATTEMPTS=3
# KAFKA_RETRY_BACKOFF_BASE=1.0
# KAFKA_CIRCUIT_BREAKER_THRESHOLD=5
# KAFKA_CIRCUIT_BREAKER_RESET_TIMEOUT=30.0
# KAFKA_CONSUMER_SLEEP_INTERVAL=0.1
# KAFKA_ACKS=all
# KAFKA_ENABLE_IDEMPOTENCE=true
# KAFKA_AUTO_OFFSET_RESET=latest
# KAFKA_ENABLE_AUTO_COMMIT=true
# KAFKA_DEAD_LETTER_TOPIC=

# =============================================================================
# Consul Service Discovery Configuration
# =============================================================================
# Consul agent connection for service registration and discovery.
# For Docker services: omninode-bridge-consul
# For host scripts: 192.168.86.200
CONSUL_HOST=localhost
CONSUL_PORT=18500
CONSUL_DNS_PORT=18600
CONSUL_SCHEME=http
CONSUL_LOG_LEVEL=INFO

# Consul advanced settings (optional - defaults shown)
# SECURITY: Replace placeholder with your Consul ACL token
# CONSUL_TOKEN=__REPLACE_WITH_CONSUL_ACL_TOKEN__
# CONSUL_TIMEOUT_SECONDS=30.0
# CONSUL_CONNECT_TIMEOUT_SECONDS=10.0
# CONSUL_DATACENTER=dc1
# CONSUL_HEALTH_CHECK_INTERVAL_SECONDS=30.0
# CONSUL_CIRCUIT_BREAKER_THRESHOLD=5
# CONSUL_CIRCUIT_BREAKER_RESET_TIMEOUT_SECONDS=30.0

# =============================================================================
# Vault Secret Management Configuration
# =============================================================================
# HashiCorp Vault connection for secure secret retrieval.
# For Docker services: http://omninode-bridge-vault:8200
# For host scripts: http://192.168.86.200:8200
VAULT_ADDR=http://localhost:8200
# SECURITY: Replace this placeholder with your Vault token
# For development: Use Vault's root token from initial setup
# For production: Use a properly scoped token with minimal permissions
VAULT_TOKEN=__REPLACE_WITH_VAULT_TOKEN__
# Optional: Vault namespace for enterprise deployments
# VAULT_NAMESPACE=

# =============================================================================
# Redis / Valkey Cache Configuration
# =============================================================================
# Redis/Valkey connection for caching and session storage.
# For Docker services: omninode-bridge-redis
# For host scripts: 192.168.86.200
REDIS_HOST=localhost
REDIS_PORT=6379
# SECURITY: Replace this placeholder with a secure password
# Generate using: openssl rand -base64 32
REDIS_PASSWORD=__REPLACE_WITH_SECURE_PASSWORD__

# =============================================================================
# RedPanda Event Streaming Configuration
# =============================================================================
# RedPanda broker ports (non-standard ports for security)
REDPANDA_PORT=19092
REDPANDA_EXTERNAL_PORT=19102
REDPANDA_ADMIN_PORT=19654
REDPANDA_PROXY_PORT=18092
REDPANDA_LOG_LEVEL=info
REDPANDA_DEFAULT_PARTITIONS=3
REDPANDA_DEFAULT_REPLICATION_FACTOR=1
REDPANDA_LOG_RETENTION_MS=604800000
REDPANDA_SEGMENT_MS=86400000

# RedPanda UI (non-standard port for security)
REDPANDA_UI_PORT=18109

# =============================================================================
# ONEX Adapter Service Ports
# =============================================================================
# PostgreSQL Adapter (non-standard port for security)
POSTGRES_ADAPTER_PORT=18085

# Consul Adapter (non-standard port for security)
CONSUL_ADAPTER_PORT=18087

# =============================================================================
# GitHub Configuration
# =============================================================================
# Token for private repository access (package installation)
GITHUB_TOKEN=your_github_token_here

# =============================================================================
# Webhook Notifications Configuration
# =============================================================================
# Slack Webhook for Infrastructure Alerts
# Get your webhook URL from: Slack App -> Incoming Webhooks -> Copy webhook URL
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Optional: Additional webhook configurations for multi-channel notifications
# DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/WEBHOOK/URL
# TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/WEBHOOK/URL

# =============================================================================
# ONEX Runtime Configuration
# =============================================================================
# Core runtime settings for the ONEX kernel and services.

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
ONEX_LOG_LEVEL=INFO

# Environment name: local, development, staging, production
ONEX_ENVIRONMENT=local

# HTTP port for health check server (internal container port)
ONEX_HTTP_PORT=8085

# Contracts directory path (for contract-driven configuration)
# CONTRACTS_DIR=./contracts

# Kafka topics for main runtime
ONEX_INPUT_TOPIC=requests
ONEX_OUTPUT_TOPIC=responses
ONEX_GROUP_ID=onex-runtime-main

# Effects runtime Kafka topics (optional)
# ONEX_EFFECTS_INPUT_TOPIC=effect-requests
# ONEX_EFFECTS_OUTPUT_TOPIC=effect-responses
# ONEX_EFFECTS_GROUP_ID=onex-runtime-effects

# Worker runtime Kafka topics (optional)
# ONEX_WORKER_INPUT_TOPIC=worker-requests
# ONEX_WORKER_OUTPUT_TOPIC=worker-responses
# ONEX_WORKER_GROUP_ID=onex-runtime-workers

# =============================================================================
# Runtime Scheduler Configuration (Optional)
# =============================================================================
# Tick scheduler for emitting RuntimeTick events.
# RUNTIME_SCHEDULER_TICK_INTERVAL_MS=1000
# RUNTIME_SCHEDULER_ID=runtime-scheduler-default
# RUNTIME_SCHEDULER_TICK_TOPIC=runtime.tick.v1
# RUNTIME_SCHEDULER_PERSIST_SEQUENCE=true
# RUNTIME_SCHEDULER_SEQUENCE_KEY=runtime_scheduler_sequence
# RUNTIME_SCHEDULER_MAX_JITTER_MS=100
# RUNTIME_SCHEDULER_CB_THRESHOLD=5
# RUNTIME_SCHEDULER_CB_RESET_TIMEOUT=60.0
# RUNTIME_SCHEDULER_ENABLE_METRICS=true
# RUNTIME_SCHEDULER_METRICS_PREFIX=runtime_scheduler

# =============================================================================
# Compute Registry Configuration (Optional)
# =============================================================================
# Semver LRU cache size for plugin version resolution.
# Increase for large deployments with many unique version strings.
# COMPUTE_REGISTRY_CACHE_SIZE=128

# =============================================================================
# Performance Threshold Configuration (Optional)
# =============================================================================
# Thresholds for performance monitoring in the registration reducer.
# Adjust for stricter production monitoring or relaxed dev/CI environments.
#
# reduce() processing threshold in milliseconds (default: 300.0)
# ONEX_PERF_THRESHOLD_REDUCE_MS=300.0
#
# Intent building threshold in milliseconds (default: 50.0)
# ONEX_PERF_THRESHOLD_INTENT_BUILD_MS=50.0
#
# Idempotency check threshold in milliseconds (default: 1.0)
# ONEX_PERF_THRESHOLD_IDEMPOTENCY_CHECK_MS=1.0

# =============================================================================
# Snapshot Topic Configuration (Optional)
# =============================================================================
# Kafka snapshot topic settings for state persistence.
# SNAPSHOT_TOPIC=onex.registration.snapshots
# SNAPSHOT_PARTITION_COUNT=12
# SNAPSHOT_REPLICATION_FACTOR=3
# SNAPSHOT_MIN_COMPACTION_LAG_MS=60000
# SNAPSHOT_MAX_COMPACTION_LAG_MS=300000
# SNAPSHOT_SEGMENT_BYTES=104857600
# SNAPSHOT_RETENTION_MS=-1
# SNAPSHOT_MIN_INSYNC_REPLICAS=2

# =============================================================================
# OpenTelemetry Observability Configuration (Optional)
# =============================================================================
# OTLP exporter endpoint for distributed tracing and metrics.
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# Service name for tracing identification
# OTEL_SERVICE_NAME=omnibase-infra-runtime

# Exporter types: otlp, console, none
# OTEL_TRACES_EXPORTER=otlp
# OTEL_METRICS_EXPORTER=otlp

# =============================================================================
# Docker/Network Configuration (Optional)
# =============================================================================
# Docker network name for inter-service communication.
# Must match the network created by omninode-bridge infrastructure.
# DOCKER_NETWORK=omninode-bridge-network

# Remote host override for extra_hosts mappings.
# Set to IP address when connecting to services on a different host.
# Default (host-gateway) resolves to the Docker host.
# REMOTE_HOST=host-gateway

# Host port mappings for runtime services
# RUNTIME_MAIN_PORT=8085
# RUNTIME_EFFECTS_PORT=8086

# Number of worker replicas for horizontal scaling
# WORKER_REPLICAS=2
