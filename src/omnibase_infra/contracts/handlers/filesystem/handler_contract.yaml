# Handler ID follows convention: {node_type}.{domain}.handler
handler_id: effect.filesystem.handler
name: FileSystem Handler
version: "1.0.0"
description: >
  Effect handler for filesystem operations including read, write, list, delete, and directory management.

descriptor:
  handler_kind: effect
  purity: side_effecting
  # Idempotent: false because write operations may append (non-idempotent).
  # Individual operations (write w/ overwrite, mkdir w/ exist_ok) can be
  # idempotent, but the handler as a whole supports non-idempotent semantics.
  idempotent: false
  timeout_ms: 30000
  retry_policy:
    enabled: true
    max_retries: 3
    backoff_strategy: exponential
    base_delay_ms: 500
    max_delay_ms: 10000
  circuit_breaker:
    enabled: true
    failure_threshold: 5
    timeout_ms: 60000
  # Serialized: Prevents race conditions for write operations to same file.
  # Read-only operations could use concurrent policy, but handler scope
  # includes writes so we use serialized for safety.
  concurrency_policy: serialized
  isolation_policy: none
  observability_level: standard
capability_outputs:
  - filesystem.read
  - filesystem.write
  - filesystem.list
  - filesystem.delete
  - filesystem.mkdir
# NOTE: Models defined in OMN-1158 (FileSystemHandler Implementation)
input_model: omnibase_infra.handlers.filesystem.ModelFileSystemRequest
output_model: omnibase_infra.handlers.filesystem.ModelFileSystemResult
supports_lifecycle: true
supports_health_check: true
supports_provisioning: false
tags:
  - filesystem
  - effect
  - infrastructure
metadata:
  author: OmniNode Team
  ticket: OMN-1160
  security:
    # SECURITY: Handler implementation MUST enforce these constraints:
    # - Validate all paths are within allowed_paths before operations
    # - Use Path.resolve() to canonicalize paths and prevent ../ attacks
    # - Check symlinks don't point outside allowed paths
    # - Reject absolute paths that escape the workspace
    allowed_paths:
      - "${WORKSPACE_ROOT}"
    max_file_size_bytes: 10485760
